

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/icon/browser_tab.svg">
  <link rel="icon" href="/img/icon/browser_tab.svg">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Go7">
  <meta name="keywords" content="">
  
    <meta name="description" content="The objective of this note is to record some bugs and solutions I encountered during cpp development for future reference. 1. Forward Declaration Code See the code and error caused below. 123456789101">
<meta property="og:type" content="article">
<meta property="og:title" content="Learn cpp from bugs">
<meta property="og:url" content="http://example.com/2025/01/29/learn-from-bugs/index.html">
<meta property="og:site_name" content="Go7">
<meta property="og:description" content="The objective of this note is to record some bugs and solutions I encountered during cpp development for future reference. 1. Forward Declaration Code See the code and error caused below. 123456789101">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-01-29T22:46:33.182Z">
<meta property="article:modified_time" content="2025-01-31T21:41:19.280Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="cpp">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>Learn cpp from bugs - Go7</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"example.com","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":false,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":false,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Go7</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Dive in</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/background/swim_from_above_2.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Learn cpp from bugs"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-01-29 17:46" pubdate>
          January 29, 2025 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          894 words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          8 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Learn cpp from bugs</h1>
            
            
              <div class="markdown-body">
                
                <p>The objective of this note is to record some bugs and solutions I encountered during cpp development for future reference.</p>
<h1 id="1-forward-declaration">1. Forward Declaration</h1>
<h2 id="code">Code</h2>
<p>See the code and error caused below.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> VEC3_H</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> VEC3_H</span><br><br><span class="hljs-comment">// #include &lt;cmath&gt;</span><br><span class="hljs-comment">// #include &lt;iostream&gt;</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;rtweekend.h&quot;</span></span><br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">vec3</span> &#123;<br>  <span class="hljs-keyword">public</span>:<br>    <span class="hljs-comment">// We use double here, but some ray tracers use float. double has greater precision and range, but is twice the size compared to float. This increase in size may be important if you&#x27;re programming in limited memory conditions (such as hardware shaders). Either one is fine — follow your own tastes.</span><br>    <span class="hljs-type">double</span> e[<span class="hljs-number">3</span>];<br><br>    <span class="hljs-built_in">vec3</span>() : e&#123;<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>&#125; &#123;&#125; <span class="hljs-comment">// default constructor</span><br>    <span class="hljs-built_in">vec3</span>(<span class="hljs-type">double</span> e0, <span class="hljs-type">double</span> e1, <span class="hljs-type">double</span> e2) : e&#123;e0, e1, e2&#125; &#123;&#125; <span class="hljs-comment">// constructor</span><br><br>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">x</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123; <span class="hljs-keyword">return</span> e[<span class="hljs-number">0</span>]; &#125;<br>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">y</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123; <span class="hljs-keyword">return</span> e[<span class="hljs-number">1</span>]; &#125;<br>    <span class="hljs-function"><span class="hljs-type">double</span> <span class="hljs-title">z</span><span class="hljs-params">()</span> <span class="hljs-type">const</span> </span>&#123; <span class="hljs-keyword">return</span> e[<span class="hljs-number">2</span>]; &#125;<br><br>    vec3 <span class="hljs-keyword">operator</span>-() <span class="hljs-type">const</span> &#123; <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec3</span>(-e[<span class="hljs-number">0</span>], -e[<span class="hljs-number">1</span>], -e[<span class="hljs-number">2</span>]); &#125;<br><br>    <span class="hljs-comment">// A const subscript operator. It allows read-only access to the elements of the array e. It returns a double element at index i in the array e.</span><br>    <span class="hljs-type">double</span> <span class="hljs-keyword">operator</span>[](<span class="hljs-type">int</span> i) <span class="hljs-type">const</span> &#123; <span class="hljs-keyword">return</span> e[i]; &#125;<br><br>    <span class="hljs-comment">// A non-const subscript operator. It allows read and write access to the elements of the array e. It returns a reference to the double element at index i in the array e, allowing the caller to modify the element.</span><br>    <span class="hljs-type">double</span>&amp; <span class="hljs-keyword">operator</span>[](<span class="hljs-type">int</span> i) &#123; <span class="hljs-keyword">return</span> e[i]; &#125;<br><br>    vec3&amp; <span class="hljs-keyword">operator</span>+=(<span class="hljs-type">const</span> vec3&amp; v) &#123;<br>        e[<span class="hljs-number">0</span>] += v.e[<span class="hljs-number">0</span>];<br>        e[<span class="hljs-number">1</span>] += v.e[<span class="hljs-number">1</span>];<br>        e[<span class="hljs-number">2</span>] += v.e[<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;<br>    &#125;<br><br>    vec3&amp; <span class="hljs-keyword">operator</span>*=(<span class="hljs-type">double</span> t) &#123;<br>        e[<span class="hljs-number">0</span>] *= t;<br>        e[<span class="hljs-number">1</span>] *= t;<br>        e[<span class="hljs-number">2</span>] *= t;<br>        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span>;<br>    &#125;<br><br>    vec3&amp; <span class="hljs-keyword">operator</span>/=(<span class="hljs-type">double</span> t) &#123;<br>        <span class="hljs-keyword">return</span> *<span class="hljs-keyword">this</span> *= <span class="hljs-number">1</span>/t;<br>    &#125;<br><br>    ... ...<br><br>    <span class="hljs-comment">// return a random vector whose x/y/z are in [0,1) to simulate a diffuse reflection</span><br>    <span class="hljs-function"><span class="hljs-type">static</span> vec3 <span class="hljs-title">random</span><span class="hljs-params">()</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec3</span>(<span class="hljs-built_in">random_double</span>(), <span class="hljs-built_in">random_double</span>(), <span class="hljs-built_in">random_double</span>());<br>    &#125;<br><br>    <span class="hljs-comment">// return a random vector whose x/y/z are in [min,max) to simulate a diffuse reflection</span><br>    <span class="hljs-function"><span class="hljs-type">static</span> vec3 <span class="hljs-title">random</span><span class="hljs-params">(<span class="hljs-type">double</span> min, <span class="hljs-type">double</span> max)</span> </span>&#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec3</span>(<span class="hljs-built_in">random_double</span>(min,max), <span class="hljs-built_in">random_double</span>(min,max), <span class="hljs-built_in">random_double</span>(min,max));<br>    &#125;<br><br>    <span class="hljs-comment">// First, use a rejection method to generate the random vector inside the unit sphere (that is, a sphere of radius 1). Pick a random point inside the cube enclosing the unit sphere (that is, where x, y, and z are all in the range [−1,+1]). If this point lies outside the unit sphere, then generate a new one until we find one that lies inside or on the unit sphere.</span><br>    <span class="hljs-function"><span class="hljs-keyword">inline</span> vec3 <span class="hljs-title">random_unit_vector</span><span class="hljs-params">()</span></span>&#123;<br>        <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;<br>            <span class="hljs-keyword">auto</span> p = vec3::<span class="hljs-built_in">random</span>(<span class="hljs-number">-1</span>,<span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">auto</span> lensq = p.<span class="hljs-built_in">length_squared</span>();<br>            <span class="hljs-comment">// if (lensq &lt;= 1)</span><br>            <span class="hljs-comment">//     return p / sqrt(lensq);</span><br>            <span class="hljs-comment">// Since floating-point numbers have finite precision, a very small value can underflow to zero when squared. So if all three coordinates are small enough (that is, very near the center of the sphere), the norm of the vector will be zero, and thus normalizing will yield the bogus vector [±inf,±inf,±inf]. To fix this, we&#x27;ll also reject points that lie inside this “black hole” around the center. With double precision (64-bit floats), we can safely support values greater than 10−160. Below is a more robust implementation.</span><br>            <span class="hljs-keyword">if</span> (<span class="hljs-number">1e-160</span> &lt; lensq &amp;&amp; lensq &lt;= <span class="hljs-number">1</span>)<br>                <span class="hljs-keyword">return</span> p / std::<span class="hljs-built_in">sqrt</span>(lensq);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-comment">// Take the dot product of the surface normal and our random vector to determine if it&#x27;s in the correct hemisphere. If the dot product is positive, then the vector is in the correct hemisphere. If the dot product is negative, then we need to invert the vector.</span><br>    <span class="hljs-function"><span class="hljs-keyword">inline</span> vec3 <span class="hljs-title">random_on_hemisphere</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; normal)</span> </span>&#123;<br>        vec3 on_unit_sphere = <span class="hljs-built_in">random_unit_vector</span>();<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">dot</span>(on_unit_sphere, normal) &gt; <span class="hljs-number">0.0</span>) <span class="hljs-comment">// In the same hemisphere as the normal</span><br>            <span class="hljs-keyword">return</span> on_unit_sphere;<br>        <span class="hljs-keyword">else</span><br>            <span class="hljs-keyword">return</span> -on_unit_sphere;<br>    &#125;<br>&#125;;<br><br><span class="hljs-comment">// point3 is just an alias for vec3, but useful for geometric clarity in the code.</span><br><span class="hljs-keyword">using</span> point3 = vec3;<br><br><br><span class="hljs-comment">// Vector Utility Functions</span><br><br><span class="hljs-comment">// An overloaded operator&lt;&lt; for the vec3 class in C++. This operator allows instances of the vec3 class to be output to an output stream, such as std::cout</span><br><span class="hljs-keyword">inline</span> std::ostream&amp; <span class="hljs-keyword">operator</span>&lt;&lt;(std::ostream&amp; out, <span class="hljs-type">const</span> vec3&amp; v) &#123;<br>    <span class="hljs-keyword">return</span> out &lt;&lt; v.e[<span class="hljs-number">0</span>] &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; v.e[<span class="hljs-number">1</span>] &lt;&lt; <span class="hljs-string">&#x27; &#x27;</span> &lt;&lt; v.e[<span class="hljs-number">2</span>];<br>&#125;<br><br>... ...<br><br><span class="hljs-keyword">inline</span> vec3 <span class="hljs-keyword">operator</span>*(<span class="hljs-type">double</span> t, <span class="hljs-type">const</span> vec3&amp; v) &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">vec3</span>(t*v.e[<span class="hljs-number">0</span>], t*v.e[<span class="hljs-number">1</span>], t*v.e[<span class="hljs-number">2</span>]);<br>&#125;<br><br><span class="hljs-keyword">inline</span> vec3 <span class="hljs-keyword">operator</span>*(<span class="hljs-type">const</span> vec3&amp; v, <span class="hljs-type">double</span> t) &#123;<br>    <span class="hljs-keyword">return</span> t * v;<br>&#125;<br><br><span class="hljs-keyword">inline</span> vec3 <span class="hljs-keyword">operator</span>/(<span class="hljs-type">const</span> vec3&amp; v, <span class="hljs-type">double</span> t) &#123;<br>    <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span>/t) * v;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">double</span> <span class="hljs-title">dot</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; u, <span class="hljs-type">const</span> vec3&amp; v)</span> </span>&#123;<br>    <span class="hljs-keyword">return</span> u.e[<span class="hljs-number">0</span>] * v.e[<span class="hljs-number">0</span>]<br>         + u.e[<span class="hljs-number">1</span>] * v.e[<span class="hljs-number">1</span>]<br>         + u.e[<span class="hljs-number">2</span>] * v.e[<span class="hljs-number">2</span>];<br>&#125;<br><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br></code></pre></td></tr></table></figure>
<h2 id="bugs">Bugs</h2>
<p>I tried to build the program but got the error below.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs shell">cmake --build build<br>[ 25%] Building CXX object CMakeFiles/inOneWeekend.dir/src/InOneWeekend/main.cc.obj<br>In file included from F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\rtweekend.h:39,<br>                 from F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\main.cc:1:<br>F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\vec3.h: In member function &#x27;vec3 vec3::random_unit_vector()&#x27;:<br>F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\vec3.h:74:26: error: no match for &#x27;operator/&#x27; (operand types are &#x27;vec3&#x27; and &#x27;double&#x27;)   74 |                 return p / std::sqrt(lensq);<br>      |                        ~ ^ ~~~~~~~~~~~~~~~~<br>      |                        |            |<br>      |                        vec3         double<br>F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\vec3.h: In member function &#x27;vec3 vec3::random_on_hemisphere(const vec3&amp;)&#x27;:<br>F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\vec3.h:81:13: error: &#x27;dot&#x27; was not declared in this scope<br>   81 |         if (dot(on_unit_sphere, normal) &gt; 0.0) // In the same hemisphere as the normal<br>      |             ^~~<br>F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\vec3.h:80:49: warning: control reaches end of non-void function [-Wreturn-type]<br>   80 |         vec3 on_unit_sphere = random_unit_vector();<br>      |                               ~~~~~~~~~~~~~~~~~~^~<br>mingw32-make[2]: *** [CMakeFiles\inOneWeekend.dir\build.make:79: CMakeFiles/inOneWeekend.dir/src/InOneWeekend/main.cc.obj] Error 1<br>mingw32-make[1]: *** [CMakeFiles\Makefile2:89: CMakeFiles/inOneWeekend.dir/all] Error 2<br>mingw32-make: *** [Makefile:90: all] Error 2<br></code></pre></td></tr></table></figure>
<h2 id="reasons-and-explanations">Reasons and explanations</h2>
<p>The errors are mainly due to missing function declarations or improper operator usage. Let’s break them down and fix them.</p>
<h3 id="1-operator-not-defined-for-vec3-double">(1) <strong>Operator <code>/</code> Not Defined for <code>vec3 / double</code></strong></h3>
<p><strong>Error Message:</strong></p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs subunit"><span class="hljs-keyword">error: </span>no match for &#x27;operator/&#x27; (operand types are &#x27;vec3&#x27; and &#x27;double&#x27;)<br></code></pre></td></tr></table></figure>
<p><strong>Problem:</strong><br>
Notice we already have an operator overload for division:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">inline</span> vec3 <span class="hljs-keyword">operator</span>/(<span class="hljs-type">const</span> vec3&amp; v, <span class="hljs-type">double</span> t) &#123;<br>    <span class="hljs-keyword">return</span> (<span class="hljs-number">1</span>/t) * v;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>However, this function is defined <strong>after</strong> it’s used inside <code>vec3::random_unit_vector()</code>. Because C++ compiles top to bottom, it doesn’t recognize the <code>/</code> operator at the time of usage.</p>
<p><strong>Fix:</strong><br>
Move the <code>/</code> operator overload <strong>above</strong> <code>random_unit_vector()</code> or explicitly declare it before usage:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">inline</span> vec3 <span class="hljs-keyword">operator</span>/(<span class="hljs-type">const</span> vec3&amp; v, <span class="hljs-type">double</span> t); <span class="hljs-comment">// Forward declaration</span><br></code></pre></td></tr></table></figure>
<hr>
<h3 id="2-dot-function-not-declared">(2) <strong><code>dot</code> Function Not Declared</strong></h3>
<p>Similarly, forward declare it before the use.</p>
<h3 id="3-control-reaches-end-of-non-void-function">(3) <strong>Control Reaches End of Non-Void Function</strong></h3>
<p><strong>Warning Message:</strong></p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-built_in">warning</span>: control reaches <span class="hljs-keyword">end</span> <span class="hljs-keyword">of</span> non-<span class="hljs-type">void</span> <span class="hljs-keyword">function</span> [-Wreturn-<span class="hljs-keyword">type</span>]<br></code></pre></td></tr></table></figure>
<p><strong>Problem:</strong><br>
In <code>random_on_hemisphere()</code>, the compiler is unsure whether all execution paths return a value.</p>
<p><strong>Fix:</strong><br>
Ensure all paths return a <code>vec3</code>:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> vec3 <span class="hljs-title">random_on_hemisphere</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; normal)</span> </span>&#123;<br>    vec3 on_unit_sphere = <span class="hljs-built_in">random_unit_vector</span>();<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">dot</span>(on_unit_sphere, normal) &gt; <span class="hljs-number">0.0</span>) <span class="hljs-comment">// In the same hemisphere as the normal</span><br>        <span class="hljs-keyword">return</span> on_unit_sphere;<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">return</span> -on_unit_sphere;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>If you’re still getting this warning, add an explicit return at the end:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">return</span> <span class="hljs-built_in">vec3</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>); <span class="hljs-comment">// Default return to satisfy compiler</span><br></code></pre></td></tr></table></figure>
<hr>
<h2 id="note">Note</h2>
<p>For forward declaration, we cannot just put two lines of declarations before vec3 because in that way it will cause “”. We also shouldn’t simply put two lines of declarations in vec3 right before the functions that take use of them because if will cause “too many parameters for this operator function”. Instead, we should also declare class vec3 and then declare the used functions and put them outside of class vec3, like below.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">// Forward declarations for functions that will be used later</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">vec3</span>;  <span class="hljs-comment">// Forward declaration of vec3 (not strictly needed unless cyclic dependency)</span><br><span class="hljs-keyword">inline</span> vec3 <span class="hljs-keyword">operator</span>/(<span class="hljs-type">const</span> vec3&amp; v, <span class="hljs-type">double</span> t);  <span class="hljs-comment">// Forward declare operator/</span><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">double</span> <span class="hljs-title">dot</span><span class="hljs-params">(<span class="hljs-type">const</span> vec3&amp; u, <span class="hljs-type">const</span> vec3&amp; v)</span></span>; <span class="hljs-comment">// Forward declare dot product</span><br></code></pre></td></tr></table></figure>
<p>Besides, here the third problem might not caused by the reason described above. Instead, it might caused by the missing declaratio of dot().</p>
<h1 id="2-correct-order-of-member-initialization">2. Correct Order of Member Initialization</h1>
<h2 id="code">Code</h2>
<p>See the class below.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> SPHERE_H</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SPHERE_H</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;hittable.h&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;vec3.h&quot;</span></span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">sphere</span> : <span class="hljs-keyword">public</span> hittable &#123;<br>  <span class="hljs-keyword">public</span>:<br>    <span class="hljs-built_in">sphere</span>(<span class="hljs-type">const</span> point3&amp; center, <span class="hljs-type">double</span> radius, std::shared_ptr&lt;material&gt; mat)<br>      : <span class="hljs-built_in">center</span>(center), <span class="hljs-built_in">radius</span>(std::<span class="hljs-built_in">fmax</span>(<span class="hljs-number">0</span>,radius)), <span class="hljs-built_in">mat</span>(mat) &#123;&#125;<br><br>  <span class="hljs-keyword">private</span>:<br>    std::shared_ptr&lt;material&gt; mat;<br>    point3 center;<br>    <span class="hljs-type">double</span> radius;<br>&#125;;<br><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br></code></pre></td></tr></table></figure>
<h2 id="bugs">Bugs</h2>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs shell">cmake --build build<br>[ 25%] Building CXX object CMakeFiles/inOneWeekend.dir/src/InOneWeekend/main.cc.obj<br>In file included from F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\main.cc:5:<br>F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\sphere.h: In constructor &#x27;sphere::sphere(const point3&amp;, double, std::shared_ptr&lt;material&gt;)&#x27;:<br>F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\sphere.h:47:12: warning: &#x27;sphere::radius&#x27; will be initialized after [-Wreorder]<br>   47 |     double radius;<br>      |            ^~~~~~<br>F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\sphere.h:45:31: warning:   &#x27;std::shared_ptr&lt;material&gt; sphere::mat&#x27; [-Wreorder]<br>   45 |     std::shared_ptr&lt;material&gt; mat;<br>      |                               ^~~<br>F:\E\learning_files\CS_Projects\RayTracing\src\InOneWeekend\sphere.h:9:5: warning:   when initialized here [-Wreorder]<br>    9 |     sphere(const point3&amp; center, double radius, std::shared_ptr&lt;material&gt; mat)<br>      |     ^~~~~~<br></code></pre></td></tr></table></figure>
<h2 id="reasons-and-explanations">Reasons and explanations</h2>
<p>The error is a member initialization order warning. This happens because the order in which member variables are initialized in <strong>the constructor does not match the order in which they are declared in the class</strong>. C++ initializes member variables in the order they are declared in the class, not in the order they appear in the constructor’s initializer list. Since mat is declared before center and radius in the class, but is initialized after them in the constructor, the compiler gives a warning.</p>
<h2 id="solution">Solution</h2>
<p>Reorder the initializer list to match the order of member declarations.</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">sphere</span>(<span class="hljs-type">const</span> point3&amp; center, <span class="hljs-type">double</span> radius, std::shared_ptr&lt;material&gt; mat)<br>  : <span class="hljs-built_in">mat</span>(mat), <span class="hljs-built_in">center</span>(center), <span class="hljs-built_in">radius</span>(std::<span class="hljs-built_in">fmax</span>(<span class="hljs-number">0</span>, radius)) &#123;&#125;<br></code></pre></td></tr></table></figure>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Learning/" class="category-chain-item">Learning</a>
  
  
    <span>></span>
    
  <a href="/categories/Learning/Programming/" class="category-chain-item">Programming</a>
  
  
    <span>></span>
    
  <a href="/categories/Learning/Programming/C/" class="category-chain-item">C++</a>
  
  

  

  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/cpp/" class="print-no-link">#cpp</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Learn cpp from bugs</div>
      <div>http://example.com/2025/01/29/learn-from-bugs/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Go7</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>January 29, 2025</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/01/29/function-types/" title="Introduction to function types in cpp">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Introduction to function types in cpp</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/01/27/cmake-cmds/" title="Commenly Used CMake Commands and Explanations">
                        <span class="hidden-mobile">Commenly Used CMake Commands and Explanations</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  




  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       Go7 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>







  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
